
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<link href="assets/images/favicon.png" rel="icon"/>
<meta content="mkdocs-1.5.3, mkdocs-material-9.5.18" name="generator"/>
<title>NYAML Docs</title>
<link href="assets/stylesheets/main.66ac8b77.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<link href="assets/_mkdocstrings.css" rel="stylesheet"/>
<script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
</head>
<body dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#table-of-contents">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header md-header--shadow" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="NYAML Docs" class="md-header__button md-logo" data-md-component="logo" href="." title="NYAML Docs">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"></path></svg>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            NYAML Docs
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Home
            
          </span>
</div>
</div>
</div>
<script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="NYAML Docs" class="md-nav__button md-logo" data-md-component="logo" href="." title="NYAML Docs">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"></path></svg>
</a>
    NYAML Docs
  </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
<span class="md-ellipsis">
    Home
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href=".">
<span class="md-ellipsis">
    Home
  </span>
</a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#introduction">
<span class="md-ellipsis">
      Introduction
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#nyaml-workflow">
<span class="md-ellipsis">
      nyaml Workflow
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#how-to-install-nyaml">
<span class="md-ellipsis">
      How to Install nyaml
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#how-to-use-nyaml-tool">
<span class="md-ellipsis">
      How to Use nyaml Tool
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#conversion-from-yaml-to-xml">
<span class="md-ellipsis">
      Conversion from YAML to XML
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#design-of-nexus-ontology-and-terms-in-yaml">
<span class="md-ellipsis">
      Design of NeXus Ontology and Terms in YAML
    </span>
</a>
<nav aria-label="Design of NeXus Ontology and Terms in YAML" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#root-section-for-base-classes-and-application-definitions">
<span class="md-ellipsis">
      Root section for base classes and application definitions:
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#nexus-group">
<span class="md-ellipsis">
      NeXus Group
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#nexus-field-and-nexus-attrubute">
<span class="md-ellipsis">
      NeXus Field and NeXus Attrubute
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#nexus-link">
<span class="md-ellipsis">
      NeXus Link
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#nexus-choice">
<span class="md-ellipsis">
      NeXus Choice
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#special-keywords-in-yaml">
<span class="md-ellipsis">
      Special Keywords in YAML
    </span>
</a>
<nav aria-label="Special Keywords in YAML" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#keyword-exists">
<span class="md-ellipsis">
      Keyword exists
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#keyword-unit">
<span class="md-ellipsis">
      Keyword unit
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#keyword-dimensions">
<span class="md-ellipsis">
      Keyword dimensions
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#keyword-enumeration">
<span class="md-ellipsis">
      Keyword enumeration
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#keyword-xref">
<span class="md-ellipsis">
      Keyword xref
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#conclusion">
<span class="md-ellipsis">
      Conclusion
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#references">
<span class="md-ellipsis">
      References
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="tutorials.md">
<span class="md-ellipsis">
    Tutorial
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="how_to_guide.md">
<span class="md-ellipsis">
    How-To-Guide
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="references.md">
<span class="md-ellipsis">
    Reference
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="explanations.md">
<span class="md-ellipsis">
    Explanation
  </span>
</a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#introduction">
<span class="md-ellipsis">
      Introduction
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#nyaml-workflow">
<span class="md-ellipsis">
      nyaml Workflow
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#how-to-install-nyaml">
<span class="md-ellipsis">
      How to Install nyaml
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#how-to-use-nyaml-tool">
<span class="md-ellipsis">
      How to Use nyaml Tool
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#conversion-from-yaml-to-xml">
<span class="md-ellipsis">
      Conversion from YAML to XML
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#design-of-nexus-ontology-and-terms-in-yaml">
<span class="md-ellipsis">
      Design of NeXus Ontology and Terms in YAML
    </span>
</a>
<nav aria-label="Design of NeXus Ontology and Terms in YAML" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#root-section-for-base-classes-and-application-definitions">
<span class="md-ellipsis">
      Root section for base classes and application definitions:
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#nexus-group">
<span class="md-ellipsis">
      NeXus Group
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#nexus-field-and-nexus-attrubute">
<span class="md-ellipsis">
      NeXus Field and NeXus Attrubute
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#nexus-link">
<span class="md-ellipsis">
      NeXus Link
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#nexus-choice">
<span class="md-ellipsis">
      NeXus Choice
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#special-keywords-in-yaml">
<span class="md-ellipsis">
      Special Keywords in YAML
    </span>
</a>
<nav aria-label="Special Keywords in YAML" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#keyword-exists">
<span class="md-ellipsis">
      Keyword exists
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#keyword-unit">
<span class="md-ellipsis">
      Keyword unit
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#keyword-dimensions">
<span class="md-ellipsis">
      Keyword dimensions
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#keyword-enumeration">
<span class="md-ellipsis">
      Keyword enumeration
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#keyword-xref">
<span class="md-ellipsis">
      Keyword xref
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#conclusion">
<span class="md-ellipsis">
      Conclusion
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#references">
<span class="md-ellipsis">
      References
    </span>
</a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1 id="table-of-contents">Table of Contents</h1>
<ol>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#nyaml-workflow">nyaml Workflow</a></li>
<li><a href="#how-to-use-nyaml-tool">How to Use nyaml Tool</a></li>
<li><a href="#conversion-from-yaml-to-xml">Conversion from YAML to XML</a></li>
<li><a href="#design-of-nexus-dataformat-and-terms-in-yaml">Design of NeXus Ontology and Terms in YAML</a></li>
<li><a href="#root-section-for-base-classes-and-application-definitions">Root section for base classes and application definitions</a></li>
<li><a href="#nexus-group">NeXus Group</a></li>
<li><a href="#nexus-field-and-nexus-attrubute">NeXus Field and NeXus Attrubute</a></li>
<li><a href="#nexus-link">NeXus Link</a></li>
<li><a href="#nexus-choice">NeXus Choice</a></li>
<li><a href="#special-keywords-in-yaml">Special Keywords in YAML</a></li>
<li><a href="#keyword-exists">Keyword <code>exists</code></a></li>
<li><a href="#keyword-unit">Keyword <code>unit</code></a></li>
<li><a href="#keyword-dimensions">Keyword <code>dimensions</code></a></li>
<li><a href="#keyword-enumeration">Keyword <code>enumeration</code></a></li>
<li><a href="#keywprd-xref">Keyword <code>xref</code></a></li>
<li><a href="#how-to-use-nyaml-tool">How to Install nyaml</a></li>
<li><a href="#conclusion">Conclusion</a></li>
<li><a href="#references">References</a></li>
</ol>
<h2 id="introduction">Introduction</h2>
<p>The NeXus data format, described by the NeXus Definition Language (NXDL), represents a concerted effort aimed at facilitating data exchange within scientific communities, particularly among those engaged in neutron, X-ray, and muon research <a href="https://doi.org/10.1107/S1600576714027575">J. Appl. Cryst. (2015). 48, 301-305</a>. It serves as a standardized framework for both data exchange and storage. At its core, the NeXus Definition Language (NXDL) functions as the cornerstone through which scientists delineate the nomenclature and organizational structure of information within NeXus data files, tailored to specific scientific techniques.</p>
<p>NXDL is used to define general data storage objects (base classes) and use them as the building blocks for defining measurement-specific or even instrument-specific data storage objects (application definitions). In this process, members and definitions of individual base classes can be used as is or customized. In essence, the process of schema development, whether for a base class or an application definition, entails crafting an NXDL schema definition file with the extension 'nxdl.xml', utilizing the Extensible Markup Language, <a href="https://www.w3.org/TR/REC-xml/REC-xml-20081126.xml">XML</a> .</p>
<p>To expedite the schema development process, we have introduced Yet Another Markup Language (<a href="https://yaml.org/">YAML</a>), which provides a syntax or style specifically tailored for defining scientific domain-driven schemas with NXDL. One significant advantage of YAML over XML is its indentation-driven approach, which eliminates the need for starting and ending tags for each entity within the schema. The <code>YAML</code> format results in a reduction of NXDL keyword repetition and allows for a more intuitive grasp of Python syntax, such as class inheritance. These benefits are attained without compromising the integrity of the original NeXus schema, which is traditionally expressed in XML format.</p>
<p>The <code>YAML</code> format, while not an official version of NeXus application definitions or base classes, necessitates a method for transcoding it into <code>XML</code>. The <a href="https://github.com/FAIRmat-NFDI/nyaml/tree/main">nyaml</a> Python package serves as a converter tool designed specifically for this purpose. It enables the conversion of NXDL from <code>YAML</code> format to <code>XML</code>, thereby enhancing the capability of NeXus schema developers to incorporate domain-specific scientific knowledge into the schema. Furthermore, the tool offers the flexibility to extend existing NeXus schemas in XML by facilitating conversion back and forth between the two formats. It is important to note that this paper does not introduce NeXus objects, terms, or types, which are fundamental for writing base class schemas or application definition schemas. For individuals new to NeXus, please refer to the official NeXus site at NeXus <a href="https://www.nexusformat.org/">official site</a>.</p>
<h2 id="nyaml-workflow">nyaml Workflow</h2>
<p>Like every scientific software, the <code>nyaml</code> tool also follows a specific workflow.</p>
<div class="mermaid">graph TD;
  subgraph Start
    id1["Input File (YAML or XML)"]
  end
  subgraph Correct File Converter
    id2["YAML Converter"]
    id3["XML Converter"]
  end
  subgraph YAML converter
    id4["Comment Collector"]
    id5["Python Dictionary Object"]
  end
  subgraph XML converter
    id6["XML Object"]
  end
  subgraph Final Product
  id7["Write XML File"]
  id8["Write YAML File"]
  end

  id1--&gt; |YAML File|id2
  id1--&gt; |XML File|id3
  id2--&gt;id4
  id4--&gt;id5
  id3--&gt;id6
  id5--&gt;id7
  id6--&gt;id8
</div>
<p>With input file the <code>nyaml</code> converter checks for the correct file type and call appropriate converter. For XML file, the XML converter parse the <code>XML</code> file, by <a href="https://lxml.de/">lxml</a> python library, into a <code>XML</code> tree object. By following the NXDL rules the converter writes the application definition or base class object into <code>yaml</code> file following the <code>nyaml</code> syntax. If the input file is <code>yaml</code> then the <code>yaml</code> converter collects the comments in a <code>Comments</code> object and parse the <code>yaml</code> file into python <code>dictionary</code> object. Later, the application definition or base classes will be written into <code>XML</code> file from the <code>Comments</code> and python <code>dictionary</code> object.</p>
<h2 id="how-to-install-nyaml">How to Install nyaml</h2>
<p>The tool is published to <code>PyPI</code> and available for plain install</p>
<pre><code class="language-bash">$ pip install nyaml
</code></pre>
<p>To contribute on the tool or to install in a develpment mode</p>
<pre><code class="language-bash">$ git clone https://github.com/FAIRmat-NFDI/nyaml.git
$ cd nyaml
$ pip install -e ".[dev]"
</code></pre>
<p>To install pre-commit hook for code formatting and linting</p>
<pre><code class="language-bash">$ pre-commit install
</code></pre>
<h2 id="how-to-use-nyaml-tool">How to Use nyaml Tool</h2>
<p>This is a command line tool to convert NeXus application definition or base class in <code>yaml</code> file format into <code>nxdl.xml</code> file format and vice-versa. The converter can be called by command</p>
<pre><code class="language-bash">$ nyaml2nxdl [OPTIONS] [INPUT_FILE]
</code></pre>
<p>with the available options:</p>
<pre><code class="language-output">  --output-file TEXT   Specify the output file path for the converted file.
  --check-consistency  Check whether YAML and NXDL can be recursively
                       converted, ensuring version consistency.
  --do-not-store-nxdl  Prevent the input NXDL file from being stored as a
                       comment at the end of the output YAML file.
  --verbose            Display keywords and value types in standard output to
                       assist in identifying issues in YAML files.
  --help               Show this message and exit.
</code></pre>
<p>The <code>--output-file</code> option if user wants to define output file name (including extension) otherwise converter will define the output file name e.g. from input file <code>NXapplication.nxdl.xml (NXapplication.yaml)</code> the resultant file will be <code>NXapplication_parser.yaml (NXapplication.nxdl.xml)</code>. With the option <code>--check-consistency</code> the converter produces the same type of file as the input, e.g. for input <code>NXapplication.nxdl.xml</code> the output file is <code>NXapplication_consistency.nxd.xml</code>. The intention for this option is to verify proper file and version conversion of the file. When converting the <code>nxdl.xml</code> file into <code>yaml</code> it also stores the <code>nxdl.xml</code> file at the end of <code>yaml</code> file with a hash. The option <code>--do-not-store-nxdl</code> prevents the <code>yaml</code> file from storing <code>nxdl.xml</code> text. The <code>verbose</code> option is to identify the issue, if there are some unexpected conversion, while converting the file from one to another.</p>
<h2 id="conversion-from-yaml-to-xml">Conversion from YAML to XML</h2>
<p>Presented below is a concise and trimmed example of the <code>NXmpes</code> application definition in <code>YAML</code> format, alongside its corresponding translation into <code>XML</code> format, as illustrated below. Subsequently, the fundamental rules governing this conversion process are elucidated. For a comprehensive understanding of the basic structure of NXDL, readers are encouraged to explore the <a href="https://manual.nexusformat.org/user_manual.html">NeXus Manual</a>. Throughout the followed discussions, various components of the NXmpes application definition will be discussed in the light of <code>nyaml</code> converter.</p>
<p><strong>NXmpes application definition in YAML format</strong></p>
<pre><code class="language-yaml">category: application
type: group
doc: |
  This is the most general application definition for multidimensional photoelectron spectroscopy.

  .. _ISO 18115-1:2023: https://www.iso.org/standard/74811.html
  .. _IUPAC Recommendations 2020: https://doi.org/10.1515/pac-2019-0404
symbols:
  doc: |
    The symbols used in the schema to specify e.g. dimensions of arrays
  n_transmission_function: |
    Number of data points in the transmission function.
NXmpes(NXobject):
  (NXentry):
    exsits: required
    definition:
      \@version:
      enumeration: [NXmpes]
    title:
    start_time(NX_DATE_TIME):
      doc: |
        Datetime of the start of the measurement.
    end_time(NX_DATE_TIME):
      exists: recommended
      doc: |
        Datetime of the end of the measurement.
    (NXinstrument):
      doc:
      - |
        Description of the MPES spectrometer and its individual parts.
      - |
        xref:
          spec: ISO 18115-1:2023
          term: 12.58
          url: https://www.iso.org/obp/ui/en/#iso:std:iso:18115:-1:ed-3:v1:en:term:12.58
      source_TYPE(NXsource):
        exists: recommended
        doc: |
          A source used to generate a beam.
      (NXmanipulator):
        exists: optional
        doc: |
          Manipulator for positioning of the sample.
        value_log(NXlog):
          exists: optional
          value(NX_NUMBER):
            unit: NX_PRESSURE
            doc: |
              In the case of an experiment in which the gas pressure changes and is recorded,
              this is an array of length m of gas pressures.
    (NXprocess):
      exists: recommended
      doc: |
        Document an event of data processing, reconstruction, or analysis for this data.
      transmission_correction(NXcalibration):
        exists: optional
        doc: |
          This calibration procedure is used to account for the different tranmsission efficiencies.
        transmission_function(NXdata):
          exists: recommended
          doc: |
            Transmission function of the electron analyser.
          \@axes:
            enumeration: [kinetic_energy]
          kinetic_energy(NX_FLOAT):
            unit: NX_ENERGY
            doc: |
              Kinetic energy values
            dimensions:
              rank: 1
              dim: [[1, n_transmission_function]]
</code></pre>
<p><strong>NXmpes application definition in nxdl.xml format</strong></p>
<pre><code class="language-xml">  &lt;?xml version='1.0' encoding='UTF-8'?&gt;
  &lt;?xml-stylesheet type="text/xsl" href="nxdlformat.xsl"?&gt;
  &lt;definition xmlns="http://definition.nexusformat.org/nxdl/3.1" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" category="application" type="group" name="NXmpes" extends="NXobject" xsi:schemaLocation="http://definition.nexusformat.org/nxdl/3.1 ../nxdl.xsd"&gt;
      &lt;symbols&gt;
          &lt;doc&gt;
              The symbols used in the schema to specify e.g. dimensions of arrays
          &lt;/doc&gt;
          &lt;symbol name="n_transmission_function"&gt;
              &lt;doc&gt;
                  Number of data points in the transmission function.
              &lt;/doc&gt;
          &lt;/symbol&gt;
      &lt;/symbols&gt;
      &lt;doc&gt;
          This is the most general application definition for multidimensional
          photoelectron spectroscopy.

          .. _ISO 18115-1:2023: https://www.iso.org/standard/74811.html
          .. _IUPAC Recommendations 2020: https://doi.org/10.1515/pac-2019-0404
      &lt;/doc&gt;
      &lt;group type="NXentry"&gt;
          &lt;field name="definition"&gt;
              &lt;attribute name="version"/&gt;
              &lt;enumeration&gt;
                  &lt;item value="NXmpes"/&gt;
              &lt;/enumeration&gt;
          &lt;/field&gt;
          &lt;field name="title"/&gt;
          &lt;field name="start_time" type="NX_DATE_TIME"&gt;
              &lt;doc&gt;
                  Datetime of the start of the measurement.
              &lt;/doc&gt;
          &lt;/field&gt;
          &lt;field name="end_time" type="NX_DATE_TIME" recommended="true"&gt;
              &lt;doc&gt;
                  Datetime of the end of the measurement.
              &lt;/doc&gt;
          &lt;/field&gt;
          &lt;group type="NXinstrument"&gt;
              &lt;doc&gt;
                  Description of the MPES spectrometer and its individual parts.

                  This concept is related to term `12.58`_ of the ISO 18115-1:2023 standard.

                  .. _12.58: https://www.iso.org/obp/ui/en/#iso:std:iso:18115:-1:ed-3:v1:en:term:12.58
              &lt;/doc&gt;
              &lt;group name="source_TYPE" type="NXsource" recommended="true"&gt;
                  &lt;doc&gt;
                      A source used to generate a beam.
                  &lt;/doc&gt;
              &lt;/group&gt;
              &lt;group type="NXmanipulator" optional="true"&gt;
                  &lt;doc&gt;
                      Manipulator for positioning of the sample.
                  &lt;/doc&gt;
                  &lt;group name="value_log" type="NXlog" optional="true"&gt;
                      &lt;field name="value" type="NX_NUMBER" units="NX_PRESSURE"&gt;
                          &lt;doc&gt;
                              In the case of an experiment in which the gas pressure changes and is recorded,
                              this is an array of length m of gas pressures.
                          &lt;/doc&gt;
                      &lt;/field&gt;
                  &lt;/group&gt;
              &lt;/group&gt;
          &lt;/group&gt;
          &lt;group type="NXprocess" recommended="true"&gt;
              &lt;doc&gt;
                  Document an event of data processing, reconstruction, or analysis for this data.
              &lt;/doc&gt;
              &lt;group name="transmission_correction" type="NXcalibration" optional="true"&gt;
                  &lt;doc&gt;
                      This calibration procedure is used to account for the different tranmsission
                      efficiencies.
                  &lt;/doc&gt;
                  &lt;group name="transmission_function" type="NXdata" recommended="true"&gt;
                      &lt;doc&gt;
                          Transmission function of the electron analyser.
                      &lt;/doc&gt;
                      &lt;attribute name="axes"&gt;
                          &lt;enumeration&gt;
                              &lt;item value="kinetic_energy"/&gt;
                          &lt;/enumeration&gt;
                      &lt;/attribute&gt;
                      &lt;field name="kinetic_energy" type="NX_FLOAT" units="NX_ENERGY"&gt;
                          &lt;doc&gt;
                              Kinetic energy values
                          &lt;/doc&gt;
                          &lt;dimensions rank="1"&gt;
                              &lt;dim index="1" value="n_transmission_function"/&gt;
                          &lt;/dimensions&gt;
                      &lt;/field&gt;
                  &lt;/group&gt;
              &lt;/group&gt;
          &lt;/group&gt;
      &lt;/group&gt;
  &lt;/definition&gt;
</code></pre>
<h2 id="design-of-nexus-ontology-and-terms-in-yaml">Design of NeXus Ontology and Terms in YAML</h2>
<h3 id="root-section-for-base-classes-and-application-definitions">Root section for base classes and application definitions:</h3>
<p>Within the YAML format, the root section denotes the top-level description of the application definition or base class schema, comprising the <code>category</code>, <code>type</code>, <code>doc</code>, <code>symbols</code> block, and the name of the schema (e.g. <code>NXmpes(NXobject)</code>). Correspondingly, the root section refers to the XML element <code>definition</code>, encompassing the first <code>doc</code> child of the <code>definition</code> and <code>symbols</code>. The definition element encapsulates essential xml attributes such as the schema's <code>name</code> (and xml attribute), the object it <code>extends</code> (an xml attribute), and the schema <code>type</code> (an xml attribute), with additional XML attributes (e.i. <code>xmlns:xsi</code>) handled by the nyaml converter. The accurate designation of category as either <code>base</code> or <code>application</code> distinguishes between an <code>application definition</code> and a <code>base class</code>. The schema name (e.i. <code>NXmpes(NXobject)</code>) with paranthesis indicates the extension of the current application definition, noting that base classes must <code>extends</code> NXobject, whereas application definitions may <code>extends</code> either <code>NXobject</code> or another <code>application definition</code> (excluding base classes). Schemas may incorporate one or multiple symbols, each imbued with specialized physical meanings beyond their literal interpretation, which are utilised over the application definition.</p>
<p><strong>A typical root section for the application definition <code>NXmpes</code> outlined</strong></p>
<pre><code class="language-yaml">category: application
type: group
doc: |
  This is the most general application definition for multidimensional photoelectron spectroscopy.

  .. _ISO 18115-1:2023: https://www.iso.org/standard/74811.html
  .. _IUPAC Recommendations 2020: https://doi.org/10.1515/pac-2019-0404
symbols:
  doc: |
    The symbols used in the schema to specify e.g. dimensions of arrays
  n_transmission_function: |
    Number of data points in the transmission function.
NXmpes(NXobject):
</code></pre>
<h3 id="nexus-group">NeXus Group</h3>
<p><a href="https://manual.nexusformat.org/design.html#design-groups">NeXus groups</a>, as instances of NeXus base classes, embody the compositional structure of application definitions. These groups can be initialized dynamically or statically, each approach offering distinct advantages.</p>
<p>Dynamic initialization allows for the instantiation of groups while implementing the NeXus definition to store data (in HDF5 file format called NeXus file). This method provides flexibility for multiple instances at the same level within the NeXus file. For instance, the group <code>(NXmanipulator)</code> can initialize multiple groups such as <code>manipulator1</code> and <code>manipulator2</code> of the base class <code>NXmanipulator</code> during data writing.</p>
<p>In contrast, static initialization, exemplified by syntax like <code>value_log(NXlog)</code>, references a single group <code>value_log</code> of the base class <code>NXlog</code>, disallowing the construction of other groups from <code>NXlog</code> at the same level. Such groups appear only once within the same level of current application definition.</p>
<p>Descriptive information about NeXus groups is encapsulated within the <code>doc</code> child of the respective group. It is important to note that the group annotation of <code>source_TYPE(NXsource)</code> or <code>(NXsource)source_TYPE</code> signifies the encapsulation of the group's <code>name</code> as <code>source_TYPE</code> and its type as <code>NXsource</code> base class. Notably, the order between <code>name</code> and <code>type</code> within the XML element must be inverted such two different syntax.</p>
<p>Furthermore, the uppercase part of the group's name can be dynamically overwritten, allowing for the instantiation of multiple instances. For example, <code>source_electric</code> and <code>source_magnetic</code> can coexist from <code>NXsource</code>. It is essential to adhere to the uppercase dynamic rules for NeXus groups, fields, and attributes.</p>
<p><strong>NeXus Groups in YAML format</strong></p>
<pre><code class="language-yaml"># NeXus groups in YAML format
source_TYPE(NXsource):
  exists: recommended
  doc: |
    A source used to generate a beam.
(NXmanipulator):
  exists: optional
  doc: |
    Manipulator for positioning of the sample.
  value_log(NXlog):
    exists: optional
</code></pre>
<h3 id="nexus-field-and-nexus-attrubute">NeXus Field and NeXus Attrubute</h3>
<p>NeXus group may contain NeXus fields, NeXus attributes, and NeXus groups. A field, that does not have preceding <code>NX</code>, and a attribute, preceded by <code>\@</code>, must have a <a href="https://manual.nexusformat.org/nxdl-types.html#index-0">NeXus type</a> (e.g.<code>NX_FLOAT</code>, <code>NX_CHAR</code>). In YAML format each NeXus field or NeXus attribute has a implicit type <code>NX_CHAR</code> otherwise type must be denoted inside the paranthesis (e.g. <code>end_time(NX_DATE_TIME)</code>). Other xml attributes of NeXus <code>field</code> and NeXus <code>attribute</code> comes as children of the field and attribute (the special keywords will be discussed on next section). The introductory text of the NeXus fields or attributes goes under <code>doc</code> child.</p>
<p>A NeXus group may encompass multiple <code>field</code>, <code>attribute</code>, and subgroup, each serving distinct purposes within the data structure. The <a href="https://manual.nexusformat.org/design.html#design-fields"><code>field</code></a>, denoted without the prefix NX, and <a href="https://manual.nexusformat.org/design.html#design-attributes"><code>attribute</code></a>, indicated by <code>\@</code>, must be associated with a NeXus type (e.g., <code>NX_FLOAT</code>, <code>NX_CHAR</code>). In YAML format, each field or attribute (NeXus attribute) implicitly assumes the type <code>NX_CHAR</code>, unless explicitly specified within parentheses (e.g., <code>end_time(NX_DATE_TIME)</code>).</p>
<p>Additionally, <code>XML</code> attributes specific to NeXus field and attribute are represented as children of the corresponding <code>field</code> or <code>attribute</code> elements (further details on special keywords will be discussed in the following section). Descriptive information pertaining to NeXus <code>field</code>s or <code>attribute</code>s is encapsulated within the <code>doc</code> child element.</p>
<p><strong>NeXus field and attribute in YAML format</strong></p>
<pre><code class="language-yaml">(NXentry):
  exsits: required
  definition:  # Field type: NX_CHAR
    \@version:  # Attribute type: NX_CHAR
    enumeration: [NXmpes]
  title:
  start_time(NX_DATE_TIME):  # Field type: NX_DATE_TIME
    doc: Datetime of the start of the measurement.
  end_time(NX_DATE_TIME):  # Field type: NX_DATE_TIME
    exists: recommended
    doc: Datetime of the end of the measurement.
</code></pre>
<h3 id="nexus-link">NeXus Link</h3>
<p>NeXus <code>link</code> concept reduces duplication of the data, while several concepts of the same kind (e.g. NeXus field or NeXus attribute) can refer to the single copy of data . In YAML format NeXus <code>link</code> is defined denoting the link in side paranthesis. At the same time the concept containing the data must be mentioned under the <code>target</code> child.</p>
<p><strong>NeXus link in YAML format</strong></p>
<pre><code class="language-yaml">reference_measurement(link):
  target: /NXentry
  doc: A link to a full data collection.
</code></pre>
<p>In the provided YAML example, <code>reference_measurement</code> is defined as a link refering the <code>NXentry</code> group with its target specified as <code>/NXentry</code>. This structure ensures that the concept referencing the data is effectively linked to the designated target, thereby reducing redundancy and maintaining data integrity within the NeXus framework.</p>
<h3 id="nexus-choice">NeXus Choice</h3>
<p>NeXus <code>choice</code> concept is designed to choice a concept from a bunch of concepts of the same kind (e.g. NeXus field). The <code>choice</code> opens the door to define a scientific concept in several mode regarding different situations.</p>
<p><strong>NeXus choice in YAML format</strong></p>
<pre><code class="language-yaml">pixel_shape(choice):
  (NXoff_geometry):
    doc: Shape description of each pixel. Use only if all pixels in the detector
      are of uniform shape.
  (NXcylindrical_geometry):
    doc: Shape description of each pixel. Use only if all pixels in the detector
      are of uniform shape and require being described by cylinders.
</code></pre>
<p>In this choice example <code>pixes_shape</code> could be anyone from groups <code>(NXoff_geometry)</code> and <code>(NXcylindrical_geometry)</code> which are depens on the geometry of pixel.</p>
<h2 id="special-keywords-in-yaml">Special Keywords in YAML</h2>
<p>To explain the context of NeXus, certain keywords hold significance beyond their literal interpretations. These special keywords are utilized to elucidate and denote various NeXus terms e.g. attributes, fields, links, and groups, thereby enhancing the clarity and specificity of the data representation.</p>
<h3 id="keyword-exists">Keyword <code>exists</code></h3>
<p>The <code>exists</code> keyword plays a pivotal role in delineating the optionality of NeXus concepts <code>attribute</code>, <code>field</code>, <code>choice</code> <code>link</code>, and <code>group</code>, during the implementation of NeXus definitions on NeXus files. It provides crucial insights into the expected presence or absence of these concepts within the NeXus data structure. By defalut all the concepts of a base class are optional, and required application definition.</p>
<p>Presently, the accepted values for the <code>exists</code> keyword encompass:</p>
<p><code>optional</code>: Denotes that the NeXus concept is not mandatory and may be absent.
<code>recommended</code>: Suggests that the NeXus concept is advisable but not mandatory.
<code>required</code>: Indicates that the NeXus concet must be present within the structure.
<code>[min, &lt;number&gt;, max, &lt;number&gt; or infty]</code>: Represents an array type value that signifies the multiplicity of the NeXus concepts. For instance, concept belonging <code>exists: [min, 3, max, infty]</code> implies that the concept must come a minimum of three instances and may extend to any number.</p>
<p><strong><code>exists</code> in YAML</strong></p>
<pre><code class="language-yaml">transmission_correction(NXcalibration):
  exists: optional
  doc: |
    This calibration procedure is used to account for the different tranmsission efficiencies.
</code></pre>
<p>In the above example the greoup <code>transmission_correction</code> is a optional group.</p>
<h3 id="keyword-unit">Keyword <code>unit</code></h3>
<p>A statement introducing NeXus-compliant NXDL attribute <code>units</code> attributes to the <code>field</code> e.g. <code>NX_VOLTAGE</code> to assign predefied pyhsical unit.</p>
<p><strong><code>unit</code> in YAML</strong></p>
<pre><code class="language-yaml">detector_voltage(NX_FLOAT):
  unit: NX_VOLTAGE
  doc: |
    Voltage applied to detector.
</code></pre>
<h3 id="keyword-dimensions">Keyword <code>dimensions</code></h3>
<p>The <code>dimensions</code> term  describes the multidimensional nature of the data, specifying its rank, dimensional indices, and corresponding length of the rank. For example, the attribute <code>rank</code> defines the dimension of the data set. To elucidate each dimension we use other two keywords <code>dim</code> and <code>dim_parameters</code>. The <code>dim</code> keyword comprises an array of arrays, the nested array encapsulates values for <code>index</code> and <code>value</code> (NeXus keywords) pairs. Each array within the <code>dim</code> array corresponds to a specific dimension of the multidimensional data. For example, for 2D particle motion, the <code>dim</code> array may be represented as <code>[[0, nx], [1, ny]]</code>, indicating the axes index and its length. Another keyword <code>dim_parameters</code> contains further information of each dimension such as <code>doc</code>, <code>ref</code>, etc. It is important to note that each term or keyword within <code>dim_parameters</code> must have the same length as the value of the rank keyword.</p>
<p><strong><code>dimensions</code> in YAML</strong></p>
<pre><code class="language-yaml"># 2D particle motion
dimensions:
   rank: 2
   dim: [[0, nx], [1, ny]]
   dim_parameters:
      doc: ["Position of particle on x-axis.","Position of particle on y-axis."]
</code></pre>
<p>The <code>dimensions</code> can also be written in shorter form
<strong>Dimensions in YAML (shorter form)</strong></p>
<pre><code class="language-yaml"># 2D particle motion
dimensions:
   rank: 2
   dim: (nx, ny)
</code></pre>
<h3 id="keyword-enumeration">Keyword <code>enumeration</code></h3>
<p>Python list of strings which are considered as recommended items for the fields or attributes.</p>
<p><strong>Enumeration in YAML</strong></p>
<pre><code class="language-yaml">definition:
  \@version:
  enumeration: [NXmpes]
</code></pre>
<p>In the example the valid value for NeXus field <code>definition</code> is <code>NXmpes</code>.</p>
<h3 id="keyword-xref">Keyword <code>xref</code></h3>
<p>The <code>xref</code> keyword used inside the <code>doc</code> to refer any other ontology or any other standard such <code>ISO</code>. The <code>xref</code> in the example <code>doc</code> will reflect the information inside the xml <code>doc</code>.</p>
<p><strong><code>xref</code> in YAML</strong></p>
<pre><code class="language-yaml">(NXinstrument):
  doc:
  - |
    Description of the MPES spectrometer and its individual parts.
  - |
    xref:
      spec: ISO 18115-1:2023
      term: 12.58
      url: https://www.iso.org/obp/ui/en/#iso:std:iso:18115:-1:ed-3:v1:en:term:12.58
</code></pre>
<h2 id="conclusion">Conclusion</h2>
<p>Defining a NeXus application definition or base class in YAML format is not a official structure of NeXus, but it a format to reduce the effor of the application developer to construct an application definition or base class. The <code>nyaml</code> is the tool that converts the application definitions or base classes from <code>YAML</code> format to <code>nxdl.xml</code> (<code>XML</code> type) format with any knowledge of <code>XML</code> style or syntax. This is a open source software funded by <a href="https://www.nfdi.de/">NFDI</a> under FARImat progect and sitting on the github repo therefore anyone can create an issue after detecting a bug, suggestion for improvement and open to contribution. The <code>nyaml</code> is also <a href="https://pypi.org/project/nyaml/">published in PyPi</a> and can be installed with <code>pip</code> python package manageer.</p>
<h2 id="references">References</h2>
<p>[@Könnecke]: J. Appl. Cryst. (2015). 48, 301-305
             (https://doi.org/10.1107/S1600576714027575)</p>
</article>
</div>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": ".", "features": [], "search": "assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
<script src="assets/javascripts/bundle.3220b9d7.min.js"></script>
<script type="module">import mermaid from "https://unpkg.com/mermaid@10.4.0/dist/mermaid.esm.min.mjs";
mermaid.initialize({});</script></body>
</html>